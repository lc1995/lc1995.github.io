<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Unity,Shader," />










<meta name="description" content="《Unity Shader 入门精要》Chapter 8 — Reading Note">
<meta name="keywords" content="Unity,Shader">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity Shader Chapter 8">
<meta property="og:url" content="http://lc1995.github.io/2018/03/22/Unity-Shader-Chapter-8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="《Unity Shader 入门精要》Chapter 8 — Reading Note">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://lc1995.github.io/images/Rendering%20Order.png">
<meta property="og:image" content="http://lc1995.github.io/images/Overlap.png">
<meta property="og:image" content="http://lc1995.github.io/images/Wrong%20Sorting.png">
<meta property="og:image" content="http://lc1995.github.io/images/BlendZWriteOn.png">
<meta property="og:image" content="http://lc1995.github.io/images/Different%20Blend.png">
<meta property="og:image" content="http://lc1995.github.io/images/BlendDoubleSided.png">
<meta property="og:updated_time" content="2018-03-22T17:29:21.167Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unity Shader Chapter 8">
<meta name="twitter:description" content="《Unity Shader 入门精要》Chapter 8 — Reading Note">
<meta name="twitter:image" content="http://lc1995.github.io/images/Rendering%20Order.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://lc1995.github.io/2018/03/22/Unity-Shader-Chapter-8/"/>





  <title>Unity Shader Chapter 8 | Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://lc1995.github.io/2018/03/22/Unity-Shader-Chapter-8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Chang Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Unity Shader Chapter 8</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-22T12:47:37+01:00">
                2018-03-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Unity/" itemprop="url" rel="index">
                    <span itemprop="name">Unity</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/03/22/Unity-Shader-Chapter-8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2018/03/22/Unity-Shader-Chapter-8/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>《Unity Shader 入门精要》Chapter 8 — Reading Note</p>
<a id="more"></a>
<h1 id="Transparent-Effect"><a href="#Transparent-Effect" class="headerlink" title="Transparent Effect"></a>Transparent Effect</h1><p>Transparent is one of the common effects in games. Usually we use the <strong>alpha channel</strong> to control the transparency of an object. When it’s set to 1, the object is absolutely opaque. When it’s set to 0, the pixel won’t display anymore.</p>
<p>There are two way to realize transparent effect:</p>
<ol>
<li><strong>Transparency Test</strong>: When a fragment’s transparency doesn’t satisfy a specific condition (usually less than a given threshold), then this fragment will be discarded. Otherwise, it will be manipulated as a normal opaque object, including depth test, ZWrite.</li>
<li><strong>Transparency Blend</strong>: By this approach we are able to obtain the real transparent effect. This will use the transparency of the current fragment as the blend factor, and blend its color with the color already stored in color buffer using the blend factor, and finally obtain the new color.</li>
</ol>
<h2 id="Why-rendering-order-is-important"><a href="#Why-rendering-order-is-important" class="headerlink" title="Why rendering order is important"></a>Why rendering order is important</h2><p>In transparency blend, we need to turn off ZWrite. That’s because if ZWrite is on, when we render a closer transparent object in fornt of another opaque object, its depth will be written into <strong>depth buffer</strong>. Then the behind surface will be removed, which means we cannot see the surface behind through the transparent object anymore, and that’s not what we want.</p>
<p>However, we need to pay attention to the rendering order now after we turn off ZWrite.</p>
<p>Example:</p>
<p><img src="/images/Rendering Order.png" alt=""></p>
<p>A(Yellow) is transparent, B(Purple) is opaque.</p>
<ul>
<li>If B firstly rendered and A secondly, it’s right.</li>
<li>If A firstly rendered and B secondly. Because we have turned off Zwrite, the render of A will not change the value in depth buffer. Then when B is rendered, it will pass the depth test and overlay the value in color buffer. Then we will see B is in front A, which is wrong.</li>
</ul>
<p>We also consider the case both two objects are transparent.</p>
<ul>
<li>If B first and A later, it’s right.</li>
<li>If contrary, A will be firstly write into color buffer, then B will blend with A in color buffer, and we will see B is in front A.</li>
</ul>
<h2 id="The-corrent-rendering-order"><a href="#The-corrent-rendering-order" class="headerlink" title="The corrent rendering order"></a>The corrent rendering order</h2><ol>
<li>Firstly render all opaque objects, and turn on their depth test and ZWrite.</li>
<li>Sort all transparent objects according to the distance between the object and the camera. Then render these transparent objects starting from the farest one.</li>
</ol>
<p>However, in some cases we will still meet some problems.</p>
<p><img src="/images/Overlap.png" alt=""></p>
<p>In this case we can deal with problem by dividing the grid. For example, in the above case we can split the object into two parts.</p>
<h2 id="Rendering-order-in-Unity"><a href="#Rendering-order-in-Unity" class="headerlink" title="Rendering order in Unity"></a>Rendering order in Unity</h2><p>In Unity, we can set the render order by <strong>Render Queue</strong>. The <strong>Queue</strong> tag in SubShader decides which render group our model is in. The smaller its index is, the early it’s rendered.</p>
<ul>
<li>Background: Rendered before any other groups, usually for background.</li>
<li>Geometry: Default render group, usually for opaque.</li>
<li>AlphaTest: Usually for alpha test.</li>
<li>Transparent: Usually for transparency blend.</li>
<li>Overlay: Used to realize some overlay effect, rendered after any other groups.</li>
</ul>
<p>Usage:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Subshader&#123;</span><br><span class="line">    Tags&#123;<span class="string">"Queue"</span>=<span class="string">"AlphaTest"</span>&#125;</span><br><span class="line">    Pass&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SubShader&#123;</span><br><span class="line">    Tags&#123;<span class="string">"Queue"</span>=<span class="string">"Transparent"</span>&#125;</span><br><span class="line">    Pass&#123;</span><br><span class="line">        ZWrite Off</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Transparency-Test"><a href="#Transparency-Test" class="headerlink" title="Transparency Test"></a>Transparency Test</h1><p>Usually we use <em>clip</em> function to do transparency test in fragment shader. <em>clip</em> is function in Cg.</p>
<blockquote>
<p>void clip(float4 x);<br>void clip(float3 x);<br>void clip(float2 x);<br>void clip(float1 x);<br>void clip(float x);</p>
<p>If any component of the given parameter is negative, then this pixel will be discard.</p>
</blockquote>
<h1 id="Transparency-Blend"><a href="#Transparency-Blend" class="headerlink" title="Transparency Blend"></a>Transparency Blend</h1><p>Blend means we use the transparency of the current fragment as the blend factor, and blend its color with the color already stored in color buffer using the blend factor, and finally obtain the new color.</p>
<p>In order to blend, we need to use the blend instruction provided by Unity — <strong>Blend</strong>.</p>
<ul>
<li>Blend Off: Turn off blend. (Default)</li>
<li>Blend SrcFactor DstFactor: Turn on blend and set blend factors.</li>
<li>Blend SrcFactor DstFactor, SrcFactorA, DstFactorA: Almost the same as above, with different setting of blend factors.</li>
<li>BlendOp BlendOperation: Use BlendOperation instead of simple blend.</li>
</ul>
<p>One common setting for the factors:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Pass&#123;</span><br><span class="line">    Zwrite Off</span><br><span class="line">    <span class="comment">// DstColorNew = SrcAlpha * SrcColor + (1 - SrcAlpha) * DstColorOld</span></span><br><span class="line">    Blend SrcAlpha OneMinusSrcAlpha</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Because we turn off Zwrite here, sometimes we will obtain a wrong transparent effect due to the wrong sorting.</p>
<p><img src="/images/Wrong Sorting.png" alt=""></p>
<p>In practice, it’s not easy to divede the grid. Instead, we can try to reuse Zwrite.</p>
<h1 id="Transparency-Blend-with-Zwrite-On"><a href="#Transparency-Blend-with-Zwrite-On" class="headerlink" title="Transparency Blend with Zwrite On"></a>Transparency Blend with Zwrite On</h1><p>We use two <strong>Pass</strong> to render the model. The first Pass turns on Zwrite. Its only goal is to write the depth value into depth buffer, which means it doesn’t output the color. The second Pass processes the normal transparency blend. Because due to the first Pass, we have obtained the correct depth value per pixel, thus we can obtain the correct transparent effect. However, using one more Pass will consume more performance.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">"Unity Shaders Book/Chapter 8/Alpha Blending ZWrite"</span>&#123;</span><br><span class="line">	Properties&#123;</span><br><span class="line">		_Color(<span class="string">"Color Tine"</span>, Color) = (<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">		_MainTex(<span class="string">"Main Tex"</span>, <span class="number">2</span>D) = <span class="string">"white"</span> &#123;&#125;</span><br><span class="line">		_AlphaScale(<span class="string">"Alpha Scale"</span>, Range(<span class="number">0</span>, <span class="number">1</span>)) = <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Subshader&#123;</span><br><span class="line">		Tags&#123;</span><br><span class="line">			<span class="string">"Queue"</span> = <span class="string">"Transparent"</span></span><br><span class="line">			<span class="string">"IgnoreProjector"</span> = <span class="string">"True"</span></span><br><span class="line">			<span class="string">"RenderType"</span> = <span class="string">"TransparentCutout"</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Pass&#123;</span><br><span class="line">			ZWrite On</span><br><span class="line">			ColorMask <span class="number">0</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Pass&#123;</span><br><span class="line">			Tags&#123;</span><br><span class="line">				<span class="string">"LightMode"</span> = <span class="string">"ForwardBase"</span></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			ZWrite Off</span><br><span class="line">			Blend SrcAlpha OneMinusSrcAlpha	</span><br><span class="line"></span><br><span class="line">			CGPROGRAM</span><br><span class="line"></span><br><span class="line">			<span class="meta">#<span class="meta-keyword">pragma</span> vertex vert</span></span><br><span class="line">			<span class="meta">#<span class="meta-keyword">pragma</span> fragment frag</span></span><br><span class="line"></span><br><span class="line">			<span class="meta">#include "Lighting.cginc"</span></span><br><span class="line"></span><br><span class="line">			fixed4 _Color;</span><br><span class="line">			sampler2D _MainTex;</span><br><span class="line">			float4 _MainTex_ST;</span><br><span class="line">			<span class="keyword">fixed</span> _AlphaScale;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">struct</span> a2v&#123;</span><br><span class="line">				float4 vertex : POSITION;</span><br><span class="line">				float3 normal : NORMAL;</span><br><span class="line">				float4 texcoord : TEXCOORD0;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">struct</span> v2f&#123;</span><br><span class="line">				float4 pos : SV_POSITION;</span><br><span class="line">				float3 worldNormal : TEXCOORD0;</span><br><span class="line">				float3 worldPos : TEXCOORD1;</span><br><span class="line">				float2 uv : TEXCOORD2;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			<span class="function">v2f <span class="title">vert</span>(<span class="params">a2v v</span>)</span>&#123;</span><br><span class="line">				v2f o;</span><br><span class="line"></span><br><span class="line">				o.pos = UnityObjectToClipPos(v.vertex);</span><br><span class="line"></span><br><span class="line">				o.worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line">				o.worldPos = mul(unity_ObjectToWorld, v.vertex);</span><br><span class="line"></span><br><span class="line">				o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">return</span> o;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="function">fixed4 <span class="title">frag</span>(<span class="params">v2f i</span>) : SV_Target</span>&#123;</span><br><span class="line">				fixed3 worldNormal = normalize(i.worldNormal);</span><br><span class="line">				fixed3 worldLightDir = normalize(UnityWorldSpaceLightDir(i.worldPos));</span><br><span class="line"></span><br><span class="line">				fixed4 texColor = tex2D(_MainTex, i.uv);</span><br><span class="line"></span><br><span class="line">				fixed3 albedo = texColor.rgb * _Color.rgb;</span><br><span class="line"></span><br><span class="line">				fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.rgb * albedo;</span><br><span class="line"></span><br><span class="line">				fixed3 diffuse = _LightColor0.rgb * albedo * saturate(dot(worldNormal, worldLightDir));</span><br><span class="line"></span><br><span class="line">				<span class="keyword">return</span> fixed4(ambient + diffuse, texColor.a * _AlphaScale);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			ENDCG</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Fallback <span class="string">"Transparent/Cutout/VertexLit"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The first Pass only writes the fragment’s depth into depth buffer, then culls off those behind. We use a new render command — <strong>ColorMask</strong> here.</p>
<blockquote>
<p>ColorMask RGB | A | 0 | Any comination of RGBA</p>
</blockquote>
<p>When it’s set to 0, it means this Pass doesn’t write anythin to the color channel, which is what we want.</p>
<p><img src="/images/BlendZWriteOn.png" alt=""></p>
<h1 id="Common-blend-type"><a href="#Common-blend-type" class="headerlink" title="Common blend type"></a>Common blend type</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Normal</span></span><br><span class="line">Blend SrcAlpha OneMinusSrcAlpha</span><br><span class="line"></span><br><span class="line"><span class="comment">// Soft Additive</span></span><br><span class="line">Blend OneMinusDstColor One</span><br><span class="line"></span><br><span class="line"><span class="comment">// Multiply</span></span><br><span class="line">Blend DstColor Zero</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2x Multiply</span></span><br><span class="line">Blend DstColor SrcColor</span><br><span class="line"></span><br><span class="line"><span class="comment">// Darken</span></span><br><span class="line">BlendOp Min</span><br><span class="line">Blend One One</span><br><span class="line"></span><br><span class="line"><span class="comment">// Lighten</span></span><br><span class="line">BlendOp Max</span><br><span class="line">Blend One One</span><br><span class="line"></span><br><span class="line"><span class="comment">// Screen</span></span><br><span class="line">Blend OneMinusDstColor One</span><br><span class="line"></span><br><span class="line"><span class="comment">// Linear Dodge</span></span><br><span class="line">Blend One One</span><br></pre></td></tr></table></figure>
<p><img src="/images/Different Blend.png" alt=""></p>
<h1 id="Transparent-Both-Sided"><a href="#Transparent-Both-Sided" class="headerlink" title="Transparent Both Sided"></a>Transparent Both Sided</h1><p>By default, the render engine doesn’t render the backside of an object (relative to the camera’s direction). Therefore, no matter we are using transparency test or blend, we can only obtain the inside view and backside view. The object looks like only a half. To solve the problem (let’s say we want to obtain a double-side effect), we can use <strong>Cull</strong> instruction to control which side we would like to cull off.</p>
<p>In Unity, syntax of Cull is as following:</p>
<blockquote>
<p>Cull Back | Front | Off</p>
</blockquote>
<ul>
<li>Back: Default setting, the backside would not be rendered.</li>
<li>Front: The front side would be culled off.</li>
<li>Off: No culling. All primitives would be rendered.</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Pass&#123;</span><br><span class="line">    Tags&#123;<span class="string">"LightMode"</span> = <span class="string">"ForwardBase"</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Turn off culling</span></span><br><span class="line">    Cull Off</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In transparency blend, we should pay attention to the rendering order. We know that the backside should be rendered earlier than the backside, but we have close ZWrite in transparency blend. To solve the problem, we can use two Pass to render both the backside and the frontside in order.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Pass&#123;</span><br><span class="line">    Tags&#123;<span class="string">"LightMode"</span> = <span class="string">"ForwardBase"</span>&#125;</span><br><span class="line"></span><br><span class="line">    Cull Front</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">Pass&#123;</span><br><span class="line">    Tags&#123;<span class="string">"LightMode"</span> = <span class="string">"ForwardBase"</span>&#125;</span><br><span class="line"></span><br><span class="line">    Cull Back</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Finally we can obtain the following effect.</p>
<p><img src="/images/BlendDoubleSided.png" alt=""></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Unity/" rel="tag"># Unity</a>
          
            <a href="/tags/Shader/" rel="tag"># Shader</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/20/Unity-Rotation-Note/" rel="next" title="Unity Rotation Note">
                <i class="fa fa-chevron-left"></i> Unity Rotation Note
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/04/Game-Ai-Chapter-5/" rel="prev" title="Game Ai Chapter 5">
                Game Ai Chapter 5 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Chang Lin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">27</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/lc1995" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:lucianolin1995@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Transparent-Effect"><span class="nav-number">1.</span> <span class="nav-text">Transparent Effect</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Why-rendering-order-is-important"><span class="nav-number">1.1.</span> <span class="nav-text">Why rendering order is important</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-corrent-rendering-order"><span class="nav-number">1.2.</span> <span class="nav-text">The corrent rendering order</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rendering-order-in-Unity"><span class="nav-number">1.3.</span> <span class="nav-text">Rendering order in Unity</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Transparency-Test"><span class="nav-number">2.</span> <span class="nav-text">Transparency Test</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Transparency-Blend"><span class="nav-number">3.</span> <span class="nav-text">Transparency Blend</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Transparency-Blend-with-Zwrite-On"><span class="nav-number">4.</span> <span class="nav-text">Transparency Blend with Zwrite On</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Common-blend-type"><span class="nav-number">5.</span> <span class="nav-text">Common blend type</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Transparent-Both-Sided"><span class="nav-number">6.</span> <span class="nav-text">Transparent Both Sided</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chang Lin</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: window.location.pathname, 
            owner: 'lc1995',
            repo: 'lc1995.github.io',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: 'f8c2095d8dc16bb768802ae8cbd0e7917eb7cb4a',
            
                client_id: 'ce5223552f85fd516b62'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
